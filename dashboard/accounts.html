<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Accounts</title>
		<link rel="stylesheet" href="styles/styles.css" />
		<link rel="icon" type="image/png" href="../images/logo.jpg" />
		<!-- <link rel="stylesheet" href="../styles/bootstrap/css/bootstrap.min.css" /> -->
		<link rel="stylesheet" href="styles/accounts.css" />
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/@mdi/font/css/materialdesignicons.min.css"
		/>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>
	</head>
	<body>
		<div class="dashboard">
			<!-- Sidebar -->
			<div class="sidebar">
				<div class="heads">
					<img class="logo" src="../images/logo4.jpg" alt="" />
					<h4>PrimeMotors</h4>
				</div>
				<ul class="menu">
					<li>
						<a href="./index.html">
							<svg
								xmlns="http://www.w3.org/2000/svg"
								height="24px"
								viewBox="0 -960 960 960"
								width="24px"
								fill="#000000"
							>
								<path
									d="M520-600v-240h320v240H520ZM120-440v-400h320v400H120Zm400 320v-400h320v400H520Zm-400 0v-240h320v240H120Zm80-400h160v-240H200v240Zm400 320h160v-240H600v240Zm0-480h160v-80H600v80ZM200-200h160v-80H200v80Zm160-320Zm240-160Zm0 240ZM360-280Z"
								/>
							</svg>
							<span>Dashboard</span>
						</a>
					</li>
					<li>
						<a href="./products.html">
							<svg
								xmlns="http://www.w3.org/2000/svg"
								height="24px"
								viewBox="0 -960 960 960"
								width="24px"
								fill="#000000"
							>
								<path
									d="m260-520 220-360 220 360H260ZM700-80q-75 0-127.5-52.5T520-260q0-75 52.5-127.5T700-440q75 0 127.5 52.5T880-260q0 75-52.5 127.5T700-80Zm-580-20v-320h320v320H120Zm580-60q42 0 71-29t29-71q0-42-29-71t-71-29q-42 0-71 29t-29 71q0 42 29 71t71 29Zm-500-20h160v-160H200v160Zm202-420h156l-78-126-78 126Zm78 0ZM360-340Zm340 80Z"
								/>
							</svg>
							<span>Products</span>
						</a>
					</li>
					<li>
						<a href="./reports.html">
							<svg
								xmlns="http://www.w3.org/2000/svg"
								height="24px"
								viewBox="0 -960 960 960"
								width="24px"
								fill="#000000"
							>
								<path
									d="M200-200v-560 560Zm0 80q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v100h-80v-100H200v560h560v-100h80v100q0 33-23.5 56.5T760-120H200Zm320-160q-33 0-56.5-23.5T440-360v-240q0-33 23.5-56.5T520-680h280q33 0 56.5 23.5T880-600v240q0 33-23.5 56.5T800-280H520Zm280-80v-240H520v240h280Zm-160-60q25 0 42.5-17.5T700-480q0-25-17.5-42.5T640-540q-25 0-42.5 17.5T580-480q0 25 17.5 42.5T640-420Z"
								/>
							</svg>
							<span>Reports</span>
						</a>
					</li>
					<li>
						<a href="./accounts.html" class="active">
							<svg
								xmlns="http://www.w3.org/2000/svg"
								height="24px"
								viewBox="0 -960 960 960"
								width="24px"
								fill="#000000"
							>
								<path
									d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-160v-112q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v112H160Zm80-80h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z"
								/>
							</svg>
							<span>Accounts</span>
						</a>
					</li>
					<li>
						<a href="./settings.html">
							<svg
								xmlns="http://www.w3.org/2000/svg"
								height="24px"
								viewBox="0 -960 960 960"
								width="24px"
								fill="#000000"
							>
								<path
									d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"
								/>
							</svg>
							<span>Settings</span>
						</a>
					</li>
				</ul>

				<div class="sidebar-bottom-portion">
					<a href="../login.html">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							height="24px"
							viewBox="0 -960 960 960"
							width="24px"
							fill="#000000"
						>
							<path
								d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h280v80H200Zm440-160-55-58 102-102H360v-80h327L585-622l55-58 200 200-200 200Z"
							/>
						</svg>
						<span>Logout</span>
					</a>
				</div>
			</div>
			<!-- end of Sidebar -->

			<div class="main-content">
				<div class="topbar">
					<div class="search">
						<input class="form-control" type="text" placeholder="Search..." />
					</div>
					<div class="user-profile">
						<span>Nick Xylan Melloria</span>
						<img src="../images/user-profile.jpg" alt="" />
					</div>
				</div>

				<div class="content">
					<div class="accounts-page">
						<h3>Accounts Management</h3>

						<div class="add-and-user-table-container">
							<!-- First Column: Add User Form -->
							<div class="col-md-3">
								<div class="card" data-bs-theme="dark" style="width: 100%">
									<div class="card-header" data-bs-theme="dark">ADD USER</div>
									<div class="card-body" data-bs-theme="dark">
										<form id="userInfoForm">
											<div class="input-group mb-3">
												<span class="input-group-text" id="basic-addon1"
													><i class="mdi mdi-id-card"></i
												></span>
												<input
													type="number"
													class="form-control"
													required
													id="stud_id"
													placeholder="Student ID"
													aria-label="Student ID"
													aria-describedby="basic-addon1"
												/>
											</div>
											<div class="input-group mb-3">
												<span class="input-group-text" id="basic-addon1"
													><i class="mdi mdi-account"></i
												></span>
												<input
													type="text"
													class="form-control"
													id="fname"
													placeholder="First Name"
													aria-label="First Name"
													aria-describedby="basic-addon1"
												/>
												<input
													type="text"
													class="form-control"
													id="lname"
													placeholder="Last Name"
													aria-label="Last Name"
													aria-describedby="basic-addon1"
												/>
											</div>
											<div class="input-group mb-3">
												<span class="input-group-text" id="basic-addon1"
													><i class="mdi mdi-email"></i
												></span>
												<input
													type="email"
													class="form-control"
													id="email"
													placeholder="Email"
													aria-label="Email"
													aria-describedby="basic-addon1"
													required
												/>
											</div>
											<div class="input-group mb-3">
												<span class="input-group-text" id="basic-addon1"
													><i class="mdi mdi-counter"></i
												></span>
												<input
													type="number"
													class="form-control"
													id="age"
													placeholder="Age"
													aria-label="Age"
													aria-describedby="basic-addon1"
												/>
											</div>
											<div class="input-group mb-3">
												<span class="input-group-text" id="basic-addon1"
													><i class="mdi mdi-marker"></i
												></span>
												<input
													type="text"
													class="form-control"
													id="address"
													placeholder="Address"
													aria-label="Address"
													aria-describedby="basic-addon2"
												/>
											</div>
											<div class="input-group mb-3">
												<button
													style="
														width: 100%;
														border-radius: 5px;
														margin-right: 20px;
													"
													class="btn btn-primary"
													type="button"
													id="addUserBtn"
													onclick="addUser()"
												>
													Add User
												</button>
												<button
													style="
														width: 100%;
														border-radius: 5px;
														margin-right: 20px;
														display: none;
													"
													class="btn btn-primary"
													type="button"
													id="updateUserBtn"
													onclick="updateUser()"
												>
													Update User
												</button>
											</div>
										</form>
									</div>
								</div>
							</div>

							<!-- Second Column: User Table -->
							<div class="col-md-9">
								<div style="margin-top: 20px" id="liveAlert"></div>
								<div class="card" data-bs-theme="dark" style="width: 100%">
									<div class="card-body" data-bs-theme="dark">
										<input
											type="text"
											style="width: 100%; margin-top: 20px; margin-bottom: 20px"
											class="form-control"
											id="search"
											placeholder="Search ..."
											aria-label="Search"
											aria-describedby="basic-addon2"
										/>
										<table id="userTable" class="table table-stripped">
											<thead>
												<tr>
													<th scope="col">ID Number</th>
													<th scope="col">First Name</th>
													<th scope="col">Last Name</th>
													<th scope="col">Email</th>
													<th scope="col">Age</th>
													<th scope="col">Address</th>
													<th scope="col">Actions</th>
												</tr>
											</thead>
											<tbody id="userTableBody" style="font-size: 13px">
												<!--- this is where the data will be added -->
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- 
			<button class="btn btn-warning btn-sm"><i class="mdi mdi-pencil"></i></button>
						<button class="btn btn-danger btn-sm" type="button" value="Delete"><i class="mdi mdi-delete"></i></button>
		 -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
		<script>
			let usersID = [];

			function deleteUser(userID) {
				// let value = $(this).val().toLowerCase();
				// let value = $(this).val().toLowerCase();
				$('#userTableBody tr').map(function () {
					console.log('current ID: ', $('#studentID').text());
					if ($('#studentID').text() === userID.toString()) {
						console.log('found');
						$(this).remove();
					} else {
						console.log('not found');
					}
				});
			}

			function addUser() {
				let stud_id = $('#stud_id').val();
				let fname = $('#fname').val();
				let lname = $('#lname').val();
				let email = $('#email').val();
				let age = $('#age').val();
				let address = $('#address').val();

				// check if student ID already exists
				if (usersID.find((userID) => userID === stud_id)) {
					$('#liveAlert').html(
						'<div class="alert alert-danger">Student ID already exists</div>'
					);
				}

				// check if any field is empty
				if (
					stud_id.length === 0 ||
					fname.length === 0 ||
					lname.length === 0 ||
					email.length === 0 ||
					age.length === 0 ||
					address.length === 0
				) {
					$('#liveAlert').html(
						'<div class="alert alert-danger">Make sure to fill up the form</div>'
					);
					return;
				}

				usersID.push(stud_id);

				// add new row
				let newRow = $('<tr></tr>');
				newRow.append(`
					<td class="stud_id" id="studentID">${stud_id}</td>
					<td class="fname">${fname}</td>
					<td class="lname">${lname}</td>
					<td class="email">${email}</td>
					<td class="age">${age}</td>
					<td class="address">${address}</td>
					<td>
						<button id="updateButton" class="btn btn-warning btn-sm"><i class="mdi mdi-pencil"></i></button>
						<button id="deleteButton" class="btn btn-danger btn-sm" type="button" value="Delete"><i class="mdi mdi-delete"></i></button>
					</td>
				`);

				$('#userTableBody').append(newRow);
				$('#liveAlert').html(
					'<div class="alert alert-success"> Data has been added. </div>'
				);

				$('#stud_id').val('');
				$('#fname').val('');
				$('#lname').val('');
				$('#email').val('');
				$('#age').val('');
				$('#address').val('');
			}

			function editUser() {
				let row = $(this).closest('tr');
				$('#stud_id').val(row.find('.stud_id').text());
				$('#fname').val(row.find('.fname').text());
				$('#lname').val(row.find('.lname').text());
				$('#email').val(row.find('.email').text());
				$('#age').val(row.find('.age').text());
				$('#address').val(row.find('.address').text());

				$('#addUserBtn').hide();
				$('#updateUserBtn').show().data('row', row);
			}

			function updateUser() {
				let row = $('#updateUserBtn').data('row');

				row.find('.stud_id').text($('#stud_id').val());
				row.find('.fname').text($('#fname').val());
				row.find('.lname').text($('#lname').val());
				row.find('.email').text($('#email').val());
				row.find('.age').text($('#age').val());
				row.find('.address').text($('#address').val());

				$('#liveAlert').html(
					'<div class="alert alert-info">User updated.</div>'
				);

				resetForm();
			}

			function resetForm() {
				$('#stud_id, #fname, #lname, #email, #age, #address').val('');
				$('#addUserBtn').show();
				$('#updateUserBtn').hide();
			}

			// delete
			$(document).on('click', '#deleteButton', function () {
				usersID = usersID.filter(
					(userID) =>
						userID !== $(this).closest('tr').children('td.stud_id').text()
				);
				$(this).closest('tr').remove();
			});

			// search
			$(document).ready(function () {
				$('#search').on('keyup', function () {
					let value = $(this).val().toLowerCase();
					$('#userTableBody tr').filter(function () {
						$(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
					});
				});

				// $(document).on('click', '.deleteButton', deleteUser);
				$(document).on('click', '#updateButton', editUser);
			});
		</script>
	</body>
</html>
